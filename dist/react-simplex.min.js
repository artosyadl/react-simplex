"use strict";function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SimplexStorage(){this.listeners=[],this.Storage={},this.sync={}}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};SimplexStorage.prototype.get=function(e){return this.Storage[e]},SimplexStorage.prototype.init=function(e){var t=this,r=arguments,n=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],o=!(arguments.length<=2||void 0===arguments[2])&&arguments[2];if(this.Storage[e]=n,this.sync[e]=o,this.hasOwnProperty(e)||Object.defineProperty(this,e,{set:function(r){t.set(e,r)},get:function(e){return t.Storage[r[0]]}}),o)try{var i=JSON.parse(localStorage.getItem("SIMPLEX_"+e));this.Storage[e]=void 0!=i&&null!=i?i:n}catch(t){console.error("Simplex: can`t sync data from localStorage for "+e)}},SimplexStorage.prototype.set=function(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];this.Storage[e]=t,this.sync[e]&&localStorage.setItem("SIMPLEX_"+e,JSON.stringify(this.Storage[e])),this.trigger(e)},SimplexStorage.prototype.onChange=function(e,t){this.listeners.push({name:e,callback:t})},SimplexStorage.prototype.trigger=function(e){var t=this,r=null;return this.listeners.forEach(function(n){0==n.name.indexOf(e)&&n.callback&&(r=n.callback.call({},_defineProperty({},e,t.Storage[e])))}),r},SimplexStorage.prototype.remove=function(e){for(var t in this.listeners)this.listeners[t].name==e&&delete this.listeners[t];this.listeners=this.listeners.filter(function(e){return e})},window.Simplex=new SimplexStorage;var SimplexConnect=function(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];if(!Array.isArray(t))return void console.error("SimplexConnect props must be an array");var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,r="x"==e?t:3&t|8;return r.toString(16)}),n=React.createClass({displayName:"Connected",getInitialState:function(){var e={};return t.forEach(function(t){e[t]=Simplex[t]}),e},componentDidMount:function(){var e=this;t.forEach(function(t){Simplex.onChange(t+"."+r,function(t){e.setState(t)})})},componentWillUnmount:function(){t.forEach(function(e){Simplex.remove(e+"."+r)})},render:function(){return React.createElement(e,_extends({},this.props,this.state))}});return n};exports.Simplex=Simplex,exports.SimplexConnect=SimplexConnect,exports.SimplexStorage=SimplexStorage;
